drop database if exists yxx;
create database yxx;
#########################################################################
#  test case 1: select outfile with enclosed and escaped param
#########################################################################
set names utf8mb4;
create table yxx.tt (id int primary key, name_1 char(127), name_2 varchar(256));
insert into yxx.tt values(1234, '"ab@cd"', x'03090A22405C5E');
insert into yxx.tt  values(1235,'ABCD','ABCD');
load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.1"))
1234	"ab@cd"	\	\
"@\\^
1235	ABCD	ABCD

load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.2"))
1234	"\"ab@cd\""	"	
\"@\\^"
1235	"ABCD"	"ABCD"

load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.3"))
1234"\"ab@cd\"""	
\"@\\^"
1235"ABCD""ABCD"

load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.4"))
1234	"""ab@cd"""	"	
""@\^"
1235	"ABCD"	"ABCD"

load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.5"))
1234"""ab@cd""""	
""@\^"
1235"ABCD""ABCD"

load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.6"))
1234"""ab@cd"""""	
""@\^"
1235"ABCD""ABCD"

load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.7"))
"1234""""ab@cd"""""	
""@\^"
"1235""ABCD""ABCD"

ERROR HY000: Wrong usage for gdb_format: field enclosement cannot be empty when `ECSV` format is used
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''csv'' at line 1
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''ecsv'' at line 1
drop table if exists yxx.tt;
#########################################################################
#  test case 2: select outfile for text and blob field type
#########################################################################
create table yxx.blobtext (id int primary key, name1 text, name2 blob);
insert into yxx.blobtext values(1, x'03090A22405C5E', x'03090A22405C5E');
load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.8"))
1"	
""@\^""	
""@\^"

drop table if exists yxx.blobtext;
#########################################################################
#  test case 3: select outfile for other charset charactors
#########################################################################
CREATE TABLE `yxx`.`onechar` (`id` int NOT NULL, `name` varchar(128) DEFAULT NULL,
PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
insert into yxx.onechar values(1, 0xF09F9891);
insert into yxx.onechar values(2, '["ABC"]');
insert into yxx.onechar values(3, '["GoldenDBåˆ›é€ è¾‰ç…Œ"]');
"modify charactor set now:"
SET @old_character_set_client= @@character_set_client;
SET @old_character_set_connection= @@character_set_connection;
SET @old_character_set_results= @@character_set_results;
SET character_set_client= 'utf8mb4';
SET character_set_connection= 'utf8mb4';
SET character_set_results= 'utf8mb4';
"continue test..."
load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.9"))
1"ğŸ˜‘"
2"[[["ABC["]"
3"[[["GoldenDBåˆ›é€ è¾‰ç…Œ["]"

"restore charactor set:"
SET @@character_set_client= @old_character_set_client;
SET @@character_set_connection= @old_character_set_connection;
SET @@character_set_results= @old_character_set_results;
drop table if exists yxx.onechar;
#########################################################################
#  test case 4: select outfile for every ASCII char
#########################################################################
create table yxx.asciitest (id int primary key, name1 text) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
insert into yxx.asciitest values(1, x'000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f');
insert into yxx.asciitest values(2,"ä¸­å…´é€šè®¯åœ¨æ•°æ®åº“é¢†åŸŸå…·å¤‡è¶…è¿‡åä¸ƒå¹´çš„æŠ€æœ¯ç§¯ç´¯ï¼Œè‡ª2002å¹´å¼€å§‹å…ˆåè‡ªä¸»ç ”å‘æ–‡ä»¶æ•°æ®åº“ã€å†…å­˜æ•°æ®åº“ã€åˆ†å¸ƒå¼æ•°æ®åº“ç­‰äº§å“å¹¶å¤§è§„æ¨¡æœåŠ¡ç”µä¿¡é¢†åŸŸäº§å“ï¼›2014å¹´ç‡å…ˆæ‹“å±•é‡‘èè¡Œä¸šåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œè¯¥äº§å“å®Œå…¨è‡ªä¸»ç ”å‘å¹¶è·å¾—100å¤šé¡¹ç›¸å…³ä¸“åˆ©ã€‚é’ˆå¯¹é“¶è¡ŒOLTPä¸šåŠ¡ï¼Œä¸­å…´é€šè®¯åˆ†å¸ƒå¼æ•°æ®åº“GoldenDBä¸ºä¸šåŠ¡å¸¦æ¥ä¼ ç»Ÿå•æœºæ•°æ®åº“æ— æ³•æä¾›çš„è®¡ç®—åŠæ‰©å±•èƒ½åŠ›ï¼Œæä¾›é«˜ å¯ç”¨ã€é«˜å¯é ã€èµ„æºè°ƒåº¦çµæ´»çš„æ•°æ®åº“æœåŠ¡ï¼Œæ”¯æŒé‡‘èè¡Œä¸šå·²æœ‰ä¸šåŠ¡å‡çº§åŠåˆ›æ–°ä¸šåŠ¡å¿«é€Ÿéƒ¨ç½²çš„éœ€æ±‚ã€‚ä¸­å…´é€šè®¯GoldenDBåˆ†å¸ƒå¼æ•°æ®åº“ å·²ç»åœ¨ä¸­ä¿¡é“¶è¡Œã€æ±Ÿè‹çœå†œæ‘ä¿¡ç”¨ç¤¾è”åˆç¤¾ã€æ±Ÿè‹é“¶è¡Œã€æ¹–å—çœæ”¿åºœã€æ¹–åŒ—ä»™æ¡ƒå¸‚æ”¿åºœç­‰å•ä½æˆåŠŸå•†ç”¨ï¼Œä¸»è¦åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼šé«˜å¹¶å‘åœº æ™¯ï¼šé’ˆå¯¹æ”¿åºœã€é‡‘èã€è¿è¥å•†ã€äº’è”ç½‘ä¸šåŠ¡å¯¹æ•°æ®åº“çš„é«˜å¹¶å‘äº¤æ˜“çš„è¦æ±‚ï¼Œä¸”å¯ä»¥ä¿è¯æ•°æ®çš„äº‹åŠ¡å¼ºä¸€è‡´æ€§ã€‚æµ·é‡æ•°æ®å­˜å‚¨è®¿é—®åœºæ™¯ï¼š é’ˆå¯¹ç°æœ‰å•æœºæ•°æ®åº“çš„å­˜å‚¨å®¹é‡å’Œæ€§èƒ½é™åˆ¶ï¼Œæä¾›å¤§å®¹é‡ã€å¯æ°´å¹³å¹³æ»‘æ‰©å®¹çš„æ•°æ®åº“è§£å†³æ–¹æ¡ˆã€‚");
load_file(concat('MYSQLTEST_VARDIR/tmp', "/outfile-test.10"))
1"
drop table if exists yxx.asciitest;
drop database yxx;
